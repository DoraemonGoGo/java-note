<!--
date: 2022-02-26T22:34:12+08:00
lastmod: 2022-02-27T22:34:12+08:00
-->
## 微服务和分布式

分布式的核心在于“拆”。将一个项目的业务按照**水平拆分**或者**垂直拆分**（也叫横向和纵向拆分）成多个模块，将这些模块分开部署（单机或集群部署），模块之间通过RPC通信，这就是分布式。

微服务就是非常微小的服务，可以理解为一种非常细粒度的垂直拆分。但是**微服务不一定需要部署到不同服务器上，也可以在同一个服务器上。**

**分布式架构强调的是服务化以及服务的分散化，微服务则更强调服务的专业化和精细分工**；从实践的角度来看，微服务架构通常是分布式架构，反之则未必成立。所以，选择微服务通常意味着需要解决分布式架构的各种难题。

## 分布式锁

分布式是跨JVM的，因此原本单机下的锁同步方案在分布式场景中是无效的，此时需要使用分布式锁来实现进程间的同步。

阻塞锁（独占锁）可以用互斥量来实现：

1）互斥量为0时表示其他进程在使用锁，此时处于锁定状态。<br>
2）互斥量为1时表示未锁定状态。

1和0可以用一个整型值表示，也可以用某个数据是否存在表示。其实就类似于把AQS底层的state变量存放到某一个地方，分布式场景中的所有服务都能访问到这个共享资源。可以有如下实现方案：

### 数据库的唯一索引

### Redis的SETNX指令

### Redis的RedLock算法

### Zookeeper的有序节点

## 参考链接

* [分布式](http://www.cyc2018.xyz/%E5%85%B6%E5%AE%83/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/%E5%88%86%E5%B8%83%E5%BC%8F.html)
* [答疑 | 分布式和微服务的区别？](https://zhuanlan.zhihu.com/p/138645236)
* [分布式服务架构与微服务架构概念的区别与联系是怎样的？](https://www.zhihu.com/question/28253777)
