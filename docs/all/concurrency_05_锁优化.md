<!--
date: 2022-02-13T22:46:12+08:00
lastmod: 2022-02-13T22:46:12+08:00
-->
## 对象头

JDK1.6对synchronized进行了优化，这里涉及到了Java对象头的知识。

存储在内存中的Java对象由对象头、实例数据和对齐填充字节组成，其中的对象头由Mark Word、指向类的指针和数组长度（只有数组对象才有）组成。

Mark Word记录了对象和锁有关的信息，当这个对象被synchronized关键字当成同步锁时，围绕这个锁的一系列操作都和Mark Word有关。

Mark Word在32位JVM中的长度是32bit，在64位JVM中长度是64bit。在32位JVM中主要存储的是描述对象的hash、锁信息，垃圾回收标记，年龄还会保存指向锁记录的指针，指向monitor的指针，偏向锁线程ID等。

JDK1.6开始在处理同步锁时存在锁升级的概念，JVM对于同步锁的处理从偏向锁开始，随着竞争越来越激烈，处理方式从偏向锁升级到轻量级锁，最终升级到重量级锁。

## 实例数据

对象的实例数据就是代码中能看到的对象变量和值。

## 对齐填充字节

因为JVM要求Java的对象占的内存大小应该是8bit的倍数，所以后面有几个字节用于把对象的大小补齐至8bit的倍数，没有特别的功能。

## 偏向锁



## 参考链接

* [Java 并发](http://www.cyc2018.xyz/Java/Java%20%E5%B9%B6%E5%8F%91.html)