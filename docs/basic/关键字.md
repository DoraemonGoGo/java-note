<!--
date: 2021-04-14T23:31:12+08:00
lastmod: 2021-04-19T23:31:12+08:00
-->
## final

1. 修饰类：表示该类不能被继承，比如String类。
2. 修饰方法：表示方法不能被重写。private 方法被隐式地指定为 final，如果在子类中定义的方法和基类中的一个 private 方法签名相同，此时子类的方法不是重写基类方法，而是在子类中定义了一个新的方法。
3. 修饰变量：表示变量为常量，对于基本类型，初次赋值后不能被修改；对于对象类型，初次赋值后引用不变，但对象本身可以被修改。

## static

### 静态变量

静态变量又名类变量，类变量属于类，被类的所有实例共享，可以通过类名来访问类变量。静态变量在内存中只存在一份。

实例变量属于实例，每创建一个实例都会产生对应的实例变量。

### 静态方法

静态方法在类加载时就已存在，不依赖于具体实例，所以静态方法必须要有实现，即静态方法不能是抽象方法。

静态方法只能访问所属类的静态变量和静态方法，方法中不能有this和super关键字，因为这两个关键字和实例对象有关。

### 静态代码块

```java
static{
    //do something
}
```

静态代码块如上所示，和静态变量、静态方法一样，在类被类加载器首次加载时被执行，之后就不会被再次执行了(除非类加载器卸载该类后重新加载这个类)。

当有多个静态代码块时按顺序执行。

### 静态内部类

非静态内部类依赖于外部类的实例，也就是说需要先创建外部类实例，才能用这个实例去创建非静态内部类。而静态内部类不需要。

静态内部类不能访问外部类的非静态的变量和方法。

```java
public class OuterClass {

    class InnerClass {
    }

    static class StaticInnerClass {
    }

    public static void main(String[] args) {
        // OuterClass.InnerClass innerClass = new InnerClass(); // 'OuterClass.this' cannot be referenced from a static context
        OuterClass outerClass = new OuterClass();
        OuterClass.InnerClass innerClass = outerClass.new InnerClass();
        OuterClass.StaticInnerClass staticInnerClass = new OuterClass.StaticInnerClass();
    }
}
```

每个类会产生一个.class文件，文件名即为类名。同样，内部类也会产生这么一个.class文件，但是它的名称却不是内部类的类名，而是有着严格的限制：外围类的名字，加上$，再加上内部类名字。

* [Java中静态内部类和非静态内部类到底有什么区别？](https://www.zhihu.com/question/285579995)

### 静态导包

在使用静态变量和方法时不用再指明 ClassName，从而简化代码，但可读性大大降低。

```java
import static com.xxx.ClassName.*;
```

## 初始化顺序

### 构造代码块

```java
public class Test{
    {
        //do something
    }
}
```

和静态代码块类似，但是没有`static`，只能出现在类中，若出现在某个方法中则是普通代码块。

构造代码块会在new实例对象时，优先于构造方法调用，也就是说，先执行完构造代码块，才会接着执行构造方法。如果在一个构造方法里调用了另一个构造方法，此时构造代码块只会被执行一次，而不是执行两次。

当有多个构造代码块时按顺序执行。

### 代码块

```java
public class Test{
    public static void main(String[] args){
        {
            //do something
        }
    }
}
```

和构造代码块类似，但是只在方法或语句中出现，执行顺序和普通语句一样，先出现就先执行。

局部代码块是为了缩短变量的生命周期，定义在局部代码块中的变量在出了代码块之后就结束其生命周期，释放内存。

### 总结

执行顺序：（优先级从高到低）

>静态代码块>main方法>构造代码块>构造方法

其中静态代码块只执行一次，构造代码块在每次创建对象是都会执行。

下面是一道与之相关的题目，执行下边的Test类，其输出的结果是什么？

```java
public class Test{
    static Test test = new Test(1);

    static{
        System.out.println("static code block");
    }

    {
        System.out.println("constructor code block");
    }

    Test(){
        System.out.println("constrctor method");
        System.out.println("a=" + a + ",b=" + b);
        a++;
        b++;
    }

    Test(int a){
        this();
        this.a = a;
        System.out.println("constrctor method2");
        System.out.println("a=" + a + ",b=" + b);
    }

    public static void main(String[] args){
        {
            System.out.println("code block");
        }

        method();

        Test test2 = new Test();
        method();
    }

    public static void method(){
        System.out.println("static method");
    }

    int a = 10;
    static int b = 100;
}
```

答案如下：

```java
constructor code block
constrctor method
a=10,b=0
constrctor method2
a=1,b=1
static code block
code block
static method
constructor code block
constrctor method
a=10,b=100
static method
```

## 参考链接

* [四、关键字](http://cyc2018.gitee.io/cs-notes/#/notes/Java%20%E5%9F%BA%E7%A1%80?id=%e5%9b%9b%e3%80%81%e5%85%b3%e9%94%ae%e5%ad%97)